---
# Copyright (c) 2021 Jakob Meng, <jakobmeng@web.de>
# vim:set fileformat=unix tabstop=2 shiftwidth=2 expandtab:
# kate: end-of-line unix; space-indent on; indent-width 2; remove-trailing-spaces modified;

# Ansible's stat and tempfile modules are not listed here because their output cannot be handled by the user

- name: Assemble configuration files from fragments
  loop: '{{ filesystem_config|default([]) }}'
  when: "'assemble' in item"
  assemble: "{{ item['assemble'] }}"
  register: filesystem_config_assemble_result

- name: Change blocks in files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'blockinfile' in item"
  blockinfile: "{{ item['blockinfile'] }}"
  register: filesystem_config_blockinfile_result

- name: Copy files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'copy' in item"
  copy: "{{ item['copy'] }}"
  register: filesystem_config_copy_result

- name: Fetch remote files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'fetch' in item"
  fetch: "{{ item['fetch'] }}"
  register: filesystem_config_fetch_result

- name: Manage files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'file' in item"
  file: "{{ item['file'] }}"
  register: filesystem_config_file_result

- name: Download files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'get_url' in item"
  get_url: "{{ item['get_url'] }}"
  register: filesystem_config_get_url_result

- name: Access git repositories
  loop: '{{ filesystem_config|default([]) }}'
  when: "'git' in item"
  git: "{{ item['git'] }}"
  register: filesystem_config_git_result

- name: Change lines in files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'lineinfile' in item"
  lineinfile: "{{ item['lineinfile'] }}"
  register: filesystem_config_lineinfile_result

- name: Regex replace in files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'replace' in item"
  replace: "{{ item['replace'] }}"
  register: filesystem_config_replace_result

- name: Slurp remote files
  loop: '{{ filesystem_config|default([]) }}'
  when: "'slurp' in item"
  slurp: "{{ item['slurp'] }}"
  register: filesystem_config_slurp_result

- name: Deploy subversion repositories
  loop: '{{ filesystem_config|default([]) }}'
  when: "'subversion' in item"
  subversion: "{{ item['subversion'] }}"
  register: filesystem_config_subversion_result

- name: Generate files from templates
  loop: '{{ filesystem_config|default([]) }}'
  when: "'template' in item"
  template: "{{ item['template'] }}"
  register: filesystem_config_template_result

- name: Unpack archives
  loop: '{{ filesystem_config|default([]) }}'
  when: "'unarchive' in item"
  unarchive: "{{ item['unarchive'] }}"
  register: filesystem_config_unarchive_result

- name: Interact with webservices
  loop: '{{ filesystem_config|default([]) }}'
  when: "'uri' in item"
  uri: "{{ item['uri'] }}"
  register: filesystem_config_uri_result

- name: Debug role variables
  debug:
    msg:
      filesystem_config_assemble_result: '{{ filesystem_config_assemble_result }}'
      filesystem_config_blockinfile_result: '{{ filesystem_config_blockinfile_result }}'
      filesystem_config_copy_result: '{{ filesystem_config_copy_result }}'
      filesystem_config_fetch_result: '{{ filesystem_config_fetch_result }}'
      filesystem_config_file_result: '{{ filesystem_config_file_result }}'
      filesystem_config_get_url_result: '{{ filesystem_config_get_url_result }}'
      filesystem_config_git_result: '{{ filesystem_config_git_result }}'
      filesystem_config_lineinfile_result: '{{ filesystem_config_lineinfile_result }}'
      filesystem_config_replace_result: '{{ filesystem_config_replace_result }}'
      filesystem_config_slurp_result: '{{ filesystem_config_slurp_result }}'
      filesystem_config_subversion_result: '{{ filesystem_config_subversion_result }}'
      filesystem_config_template_result: '{{ filesystem_config_template_result }}'
      filesystem_config_unarchive_result: '{{ filesystem_config_unarchive_result }}'
      filesystem_config_uri_result: '{{ filesystem_config_uri_result }}'
  tags:
    - never
    - debug
